<!doctype html>
<html lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-alpha.72">
<link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="WKP Technical Documentation Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="WKP Technical Documentation Blog Atom Feed"><title data-react-helmet="true">Implementing Team Workspaces | WKP Technical Documentation</title><meta data-react-helmet="true" property="og:url" content="https://weaveworks.github.io/wkp-docs//docs/2.4.2/team-workspaces/usage-guide"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="2.4.2"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-2.4.2"><meta data-react-helmet="true" property="og:title" content="Implementing Team Workspaces | WKP Technical Documentation"><meta data-react-helmet="true" name="description" content="What are Team Workspaces?"><meta data-react-helmet="true" property="og:description" content="What are Team Workspaces?"><link data-react-helmet="true" rel="shortcut icon" href="/img/favicon_150px.png"><link data-react-helmet="true" rel="canonical" href="https://weaveworks.github.io/wkp-docs//docs/2.4.2/team-workspaces/usage-guide"><link data-react-helmet="true" rel="alternate" href="https://weaveworks.github.io/wkp-docs//docs/2.4.2/team-workspaces/usage-guide" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://weaveworks.github.io/wkp-docs//docs/2.4.2/team-workspaces/usage-guide" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.68a53ba0.css">
<link rel="preload" href="/assets/js/styles.2455ccc5.js" as="script">
<link rel="preload" href="/assets/js/runtime~main.5922fff2.js" as="script">
<link rel="preload" href="/assets/js/main.0e16a271.js" as="script">
<link rel="preload" href="/assets/js/1.88bfafc3.js" as="script">
<link rel="preload" href="/assets/js/2.e8da588b.js" as="script">
<link rel="preload" href="/assets/js/3.e8bbdb70.js" as="script">
<link rel="preload" href="/assets/js/1be78505.f0d76dc0.js" as="script">
<link rel="preload" href="/assets/js/142.d7e6d278.js" as="script">
<link rel="preload" href="/assets/js/cb9bbae0.d7f83eb7.js" as="script">
<link rel="preload" href="/assets/js/17896441.e06f1a31.js" as="script">
<link rel="preload" href="/assets/js/83196782.432725ad.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#main" class="skipToContent_1oUP">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle" type="button" tabindex="0"><svg aria-label="Menu" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><img src="/img/weave-logo.png" alt="WKP docs" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/img/weave-logo.png" alt="WKP docs" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"><strong class="navbar__title">WKP Docs</strong></a><a class="navbar__item navbar__link navbar__link--active" href="/docs/2.4.2/">Getting Started</a><a class="navbar__item navbar__link navbar__link--active" href="/docs/2.4.2/deploying-wkp/hosts">Install</a><a class="navbar__item navbar__link navbar__link--active" href="/docs/2.4.2/tasks/using-the-eks-d-distribution">Tasks</a><a class="navbar__item navbar__link navbar__link--active" href="/docs/2.4.2/cluster-operations/user-workloads">Cluster Operations</a></div><div class="navbar__items navbar__items--right"><a class="navbar__item navbar__link navbar__link--active" href="/docs/2.4.2/download">WKP Downloads</a><a class="navbar__item navbar__link navbar__link--active" href="/docs/2.4.2/release-notes">Release Notes</a><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a class="navbar__item navbar__link" href="/docs/2.4.2/">2.4.2</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/docs/next/team-workspaces/usage-guide">main</a></li><li><a class="dropdown__link" href="/docs/team-workspaces/usage-guide">2.5.0</a></li><li><a aria-current="page" class="dropdown__link dropdown__link--active" href="/docs/2.4.2/team-workspaces/usage-guide">2.4.2</a></li></ul></div><a href="https://github.com/weaveworks/wkp-docs/tree/main" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub</a><div class="react-toggle react-toggle--disabled displayOnlyInLargeViewport_GrZ2"><div class="react-toggle-track"><div class="react-toggle-track-check"><span class="toggle_71bT">ðŸŒœ</span></div><div class="react-toggle-track-x"><span class="toggle_71bT">ðŸŒž</span></div></div><div class="react-toggle-thumb"></div><input type="checkbox" disabled="" aria-label="Dark mode toggle" class="react-toggle-screenreader-only"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/"><img src="/img/weave-logo.png" alt="WKP docs" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/img/weave-logo.png" alt="WKP docs" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"><strong class="navbar__title">WKP Docs</strong></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a class="menu__link navbar__link--active" href="/docs/2.4.2/">Getting Started</a></li><li class="menu__list-item"><a class="menu__link navbar__link--active" href="/docs/2.4.2/deploying-wkp/hosts">Install</a></li><li class="menu__list-item"><a class="menu__link navbar__link--active" href="/docs/2.4.2/tasks/using-the-eks-d-distribution">Tasks</a></li><li class="menu__list-item"><a class="menu__link navbar__link--active" href="/docs/2.4.2/cluster-operations/user-workloads">Cluster Operations</a></li><li class="menu__list-item"><a class="menu__link navbar__link--active" href="/docs/2.4.2/download">WKP Downloads</a></li><li class="menu__list-item"><a class="menu__link navbar__link--active" href="/docs/2.4.2/release-notes">Release Notes</a></li><li class="menu__list-item"><a role="button" class="menu__link menu__link--sublist">Versions</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/docs/next/team-workspaces/usage-guide">main</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/team-workspaces/usage-guide">2.5.0</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active" href="/docs/2.4.2/team-workspaces/usage-guide">2.4.2</a></li></ul></li><li class="menu__list-item"><a href="https://github.com/weaveworks/wkp-docs/tree/main" target="_blank" rel="noopener noreferrer" class="menu__link">GitHub</a></li></ul></div></div></div></nav><div class="main-wrapper main-docs-wrapper"><div class="docPage_31aa"><div class="docSidebarContainer_3Kbt" role="complementary"><div class="sidebar_15mo"><div class="menu menu--responsive thin-scrollbar menu_Bmed"><button aria-label="Open menu" aria-haspopup="true" class="button button--secondary button--sm menu__button" type="button"><svg aria-label="Menu" class="sidebarMenuIcon_fgN0" width="24" height="24" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><ul class="menu__list"><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Getting Started</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/2.4.2/">Introduction to wk</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/2.4.2/getting-started/wk">The wk command</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/2.4.2/getting-started/entitlements">Configuring Entitlements</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/2.4.2/getting-started/git-config-repository">Managing the Git Configuration Repository</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/2.4.2/getting-started/known-issues">Known Issues and Work Arounds</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Deploying WKP</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/2.4.2/deploying-wkp/hosts">Cluster Node Requirements</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/2.4.2/deploying-wkp/cluster-creation-on-ssh-nodes">Creating Clusters on SSH Nodes</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/2.4.2/deploying-wkp/components-on-existing-cluster">Install to an Existing Cluster</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/2.4.2/deploying-wkp/cluster-creation-on-eks">Installing WKP to EKS</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/2.4.2/deploying-wkp/cluster-creation-on-footloose">Installing WKP on Footloose</a></li></ul></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!">Team Workspaces</a><ul class="menu__list"><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active active" tabindex="0" href="/docs/2.4.2/team-workspaces/usage-guide">Implementing Team Workspaces</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/2.4.2/team-workspaces/team-permissions">Specifying Team Permissions</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/2.4.2/team-workspaces/member-guide">Deploying Workloads</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Cluster Operations</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/2.4.2/cluster-operations/user-workloads">Running and Managing Workloads</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/2.4.2/cluster-operations/adding-removing-nodes">Adding and Removing Nodes</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/2.4.2/cluster-operations/upgrading-kubernetes-version">Upgrading Kubernetes</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/2.4.2/cluster-operations/custom-kubernetes-configuration">Customizing the API Server and Kubelet</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/2.4.2/cluster-operations/auth">Securing the WKP UI</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/2.4.2/cluster-operations/managing-secrets">Managing Secrets</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/2.4.2/cluster-operations/sealing-key">Managing the Sealing Key</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Monitoring</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/2.4.2/monitoring/introduction">WKP Monitoring Tools</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/2.4.2/monitoring/alerts">Alerts</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/2.4.2/monitoring/dashboards">Dashboards</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Tasks</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/2.4.2/tasks/using-the-eks-d-distribution">Configuring EKS-D</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/2.4.2/tasks/multiple-cluster-admins">Specifying Multiple Admins</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/2.4.2/tasks/patching-node-os-packages">Patching Node OS packages</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/2.4.2/tasks/profiling-kubectl">Profiling kubectl</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Troubleshooting</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/2.4.2/troubleshooting/help">Debugging a Problem</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/2.4.2/troubleshooting/kubelet">Troubleshooting kubelet</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/2.4.2/troubleshooting/controller">Troubleshooting wks-controller</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/2.4.2/troubleshooting/scope">WKP Scope</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/2.4.2/tasks/patching-node-os-packages">Patching Node OS packages</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/2.4.2/tasks/profiling-kubectl">Profiling kubectl</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">FAQ</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/2.4.2/FAQ/faq">Frequently Asked Questions</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Reference</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/2.4.2/reference/reference">Cluster and Machine Objects</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/2.4.2/reference/cluster">cluster.yaml</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/2.4.2/reference/machines">machines.yaml</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Thirdparty Dependencies</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/2.4.2/deps/dependencies">Third-party Dependencies</a></li></ul></li><li class="menu__list-item"><a class="menu__link" href="/docs/2.4.2/download">Downloading WKP</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/2.4.2/release-notes">Release Notes</a></li></ul></div></div></div><main class="docMainContainer_3ufF"><div class="container padding-vert--lg docItemWrapper_3FMP"><div class="row"><div class="col docItemCol_3FnS"><div class="alert alert--warning margin-bottom--md" role="alert"><div>This is documentation for WKP Technical Documentation <strong>2.4.2</strong>, which is no longer actively maintained.</div><div class="margin-top--md">For up-to-date documentation, see the <strong><a href="/docs/team-workspaces/usage-guide">latest version</a></strong> (2.5.0).</div></div><div class="docItemContainer_33ec"><article><div><span class="badge badge--secondary">Version: 2.4.2</span></div><header><h1 class="docTitle_3a4h">Implementing Team Workspaces</h1></header><div class="markdown"><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="what-are-team-workspaces"></a>What are Team Workspaces?<a class="hash-link" href="#what-are-team-workspaces" title="Direct link to heading">#</a></h2><p>A workspace is a GitOps repository tied to one or more namespaces in a WKP cluster and a set of Kubernetes controllers that are keeping them in sync. All Kubernetes objects created in the workspace repository are applied to the specified namespace(s) by the controllers. One can create a workspace by adding a Workspace custom resource manifest in the cluster repository.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="how-to-enable-the-team-workspaces-feature"></a>How to: Enable the team workspaces feature<a class="hash-link" href="#how-to-enable-the-team-workspaces-feature" title="Direct link to heading">#</a></h2><p>To enable the team workspaces feature edit the <code>setup/config.yaml</code> file, set the <code>enabledFeatures: teamWorkspaces</code>
field to <code>true</code>, commit and push to the cluster repository.</p><p>After a few seconds, the team workspaces components are deployed in the <code>wkp-workspaces</code> namespace.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="how-to-create-and-use-a-team-workspace"></a>How To: Create and use a team workspace<a class="hash-link" href="#how-to-create-and-use-a-team-workspace" title="Direct link to heading">#</a></h2><p>The team workspaces feature supports the creation of repositories in either GitHub or GitLab. It also supports self-hosted instances of the above.</p><p>New team workspace repositories will be created in an organization. A personal access token is therefore needed for the succesful creation of the workspace repository and the setup of its deploy keys.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="using-a-github-token"></a>Using a GitHub token<a class="hash-link" href="#using-a-github-token" title="Direct link to heading">#</a></h3><ol><li><p>Choose a user that is a member of your organization. Using the GitHub UI, create a personal access token for this user that has <code>repo</code> and <code>admin:org</code> permissions and store it in an environment variable i.e.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><div tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token builtin class-name" style="color:rgb(255, 203, 107)">export</span><span class="token plain"> </span><span class="token assign-left variable" style="color:rgb(191, 199, 213)">GITHUB_TOKEN</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token punctuation" style="color:rgb(199, 146, 234)">..</span><span class="token plain">.</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div></li><li><p>Run the following command to generate a sealed secret manifest for the token:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><div tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">wk workspaces add-provider --type github --token </span><span class="token variable" style="color:rgb(191, 199, 213)">$GITHUB_TOKEN</span><span class="token plain"> --secret-name github-token</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>The <code>--secret-name</code> parameter indicates the name of the secret that will be created in the cluster. The name of the secret needs to be unique as there can be more than one git providers used at any given point.</p><p>For self-hosted instances, you need to also specify the <code>--hostname</code> parameter:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><div tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">wk workspaces add-provider --type github --token </span><span class="token variable" style="color:rgb(191, 199, 213)">$GITHUB_TOKEN</span><span class="token plain"> --secret-name github-token --hostname github.wkp.weave.works</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>If this parameter is not specified, the <code>--hostname</code> parameter will default to <code>github.com</code>
After running this command, a new manifest containing a sealed secret for the git provider token should be generated in the <code>./cluster/platform/workspaces</code> directory.</p></li><li><p>Push the sealed secret to the config repository, so that flux can apply it:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><div tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token function" style="color:rgb(130, 170, 255)">git</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">add</span><span class="token plain"> ./cluster/platform/workspaces/git-provider-github-token.yaml</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">git</span><span class="token plain"> commit -m </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;Add git provider token&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">git</span><span class="token plain"> push origin master</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>This step can be skipped if the <code>--git-commit-push</code> parameter is present in the previous step.</p></li></ol><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="using-a-gitlab-token"></a>Using a GitLab token<a class="hash-link" href="#using-a-gitlab-token" title="Direct link to heading">#</a></h3><ol><li><p>Choose a user that is a member of your organization. Using the GitLab UI, create a personal access token for this user that has the <code>api</code> permission and store it in an environment variable i.e.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><div tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token builtin class-name" style="color:rgb(255, 203, 107)">export</span><span class="token plain"> </span><span class="token assign-left variable" style="color:rgb(191, 199, 213)">GITLAB_TOKEN</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token punctuation" style="color:rgb(199, 146, 234)">..</span><span class="token plain">.</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div></li><li><p>Run the following command to generate a sealed secret manifest for the token:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><div tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">wk workspaces add-provider --type gitlab --token </span><span class="token variable" style="color:rgb(191, 199, 213)">$GITLAB_TOKEN</span><span class="token plain"> --secret-name gitlab-token</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>The <code>--secret-name</code> parameter indicates the name of the secret that will be created in the cluster. The name of the secret needs to be unique as there can be more than one git providers used at any given point.</p><p>For self-hosted instances, you need to also specify the <code>--hostname</code> parameter:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><div tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">wk workspaces add-provider --type gitlab --token </span><span class="token variable" style="color:rgb(191, 199, 213)">$GITLAB_TOKEN</span><span class="token plain"> --secret-name gitlab-token --hostname gitlab.wkp.weave.works</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>If this parameter is not specified, the <code>--hostname</code> parameter will default to <code>gitlab.com</code>
After running this command, a new manifest containing a sealed secret for the git provider token should be generated in the <code>./cluster/platform/workspaces</code> directory.</p></li><li><p>Push the sealed secret to the config repository, so that flux can apply it:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><div tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token function" style="color:rgb(130, 170, 255)">git</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">add</span><span class="token plain"> ./cluster/platform/workspaces/git-provider-gitlab-token.yaml</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">git</span><span class="token plain"> commit -m </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;Add git provider token&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">git</span><span class="token plain"> push origin master</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>This step can be skipped if the <code>--git-commit-push</code> parameter is present in the previous step.</p></li></ol><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="adding-a-token-manually"></a>Adding a token manually<a class="hash-link" href="#adding-a-token-manually" title="Direct link to heading">#</a></h3><p>The <code>wk workspaces add-provider</code> command is a convenient way to add a provider token to the cluster. It is also possible to add a token manually which can be useful in cases where a solution like <a href="https://github.com/mozilla/sops" target="_blank" rel="noopener noreferrer">SOPS</a> or <a href="https://www.vaultproject.io/" target="_blank" rel="noopener noreferrer">Vault</a> is used to store secrets.</p><p>For example, the following command will generate a sealed secret manifest for the token:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><div tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">kubectl create secret -n wkp-workspaces generic github-token --from-literal</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">token</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token variable" style="color:rgb(191, 199, 213)">$GITHUB_TOKEN</span><span class="token plain"> --dry-run -o yaml </span><span class="token operator" style="color:rgb(137, 221, 255)">|</span><span class="token plain"> kubeseal -o yaml </span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;</span><span class="token plain"> ./cluster/platform/workspaces/git-provider-github-token.yaml</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>However, the generated secret will need some additional metadata in order for it to be used by other parts of the WKP platform. In those cases where a git provider token needs to be created manually, please ensure the following label and annotations are in place for the secret:</p><p>Label:</p><p><code>wkp.weave.works/type: git-provider-token</code></p><p>Annotations:</p><p><code>wkp.weave.works/git-provider-type: github</code> or <code>wkp.weave.works/git-provider-type: gitlab</code> depending on the git provider used.</p><p><code>wkp.weave.works/git-provider-hostname: github.com</code> or <code>wkp.weave.works/git-provider-hostname: gitlab.com</code> depending on the git provider used.</p><p>If a self-hosted instance is used then the <code>wkp.weave.works/git-provider-hostname</code> annotation needs to point to the hostname of that instance i.e. <code>wkp.weave.works/git-provider-hostname: git.wkp.weave.works</code></p><p>You can use <code>kubectl</code> to create the above after the secret has been created:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><div tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">kubectl label secrets github-token wkp.weave.works/type</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">git-provider-token</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">kubectl annotate secrets github-token wkp.weave.works/git-provider-type</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">github</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">kubectl annotate secrets github-token wkp.weave.works/git-provider-hostname</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">git.wkp.weave.works</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="creating-a-workspace"></a>Creating a Workspace<a class="hash-link" href="#creating-a-workspace" title="Direct link to heading">#</a></h3><p>Once the secret is deployed to the cluster, you can start creating team workspaces:</p><ol><li><p>Create a Workspace manifest:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly yaml"><div tabindex="0" class="prism-code language-yaml codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token key atrule">apiVersion</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> wkp.weave.works/v1beta1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token key atrule">kind</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> Workspace</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token key atrule">metadata</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">name</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> demo</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">namespace</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> wkp</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">workspaces</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token key atrule">spec</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">interval</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> 1m</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">suspend</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token boolean important" style="color:rgb(255, 88, 116)">false</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">gitProvider</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token key atrule">type</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> github</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token key atrule">hostname</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> github.com</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token key atrule">tokenRef</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token key atrule">name</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> github</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">token </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># the git provider token created previously</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">gitRepository</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token key atrule">name</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> team</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">victor </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># &lt;- specify repository name</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token key atrule">owner</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> wkp</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">example</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">org </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># &lt;- replace org with your GitHub organization</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token key atrule">branch</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> main </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># &lt;- specify which repository branch should contain workloads (optional)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token key atrule">path</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;./&quot;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># &lt;- specify which directory within the repository should contain workloads (optional)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token key atrule">teams</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> team</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">victor </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># &lt;- specify which teams should be given access to the repository (optional)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">clusterScope</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token key atrule">role</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> namespace</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">admin</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token key atrule">namespaces</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> </span><span class="token key atrule">name</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> demo</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">app </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># &lt;- target namespace</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token key atrule">resourceQuota</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># &lt;- optional field, defines a resource quota for namespace</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          </span><span class="token key atrule">hard</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            </span><span class="token key atrule">requests.cpu</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;1&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            </span><span class="token key atrule">requests.memory</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> 1Gi</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            </span><span class="token key atrule">limits.cpu</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;2&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            </span><span class="token key atrule">limits.memory</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> 2Gi</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> </span><span class="token key atrule">name</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> demo</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">db </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># &lt;- another target namespace</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token key atrule">limitRange</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain">   </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># &lt;- optional field, defines a limit range for namespace</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          </span><span class="token key atrule">limits</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> </span><span class="token key atrule">type</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> Container</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            </span><span class="token key atrule">max</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">              </span><span class="token key atrule">memory</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> 1Gi</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            </span><span class="token key atrule">min</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">              </span><span class="token key atrule">memory</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> 500Mi</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token key atrule">networkPolicy</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> workspace</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">isolation </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># &lt;- optional field, sets a predefined network policy in the target namespaces</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div></li><li><p>Commit the manifest to the <code>cluster/manifests</code> directory in the config repository.</p></li><li><p>Wait until the <code>wkp-workspaces-controller</code> creates the namespace(s). This shouldn&#x27;t take longer than the sync interval specified in the manifest plus a few seconds.</p><ul><li><em>Note: for troubleshooting, check the <code>wkp-workspaces-controller</code> logs (for applying failures) and <code>source-controller</code> logs (for GitHub API errors)</em></li></ul></li><li><p>Commit something to the newly created workspace repository (accessible by the workspace link in the UI). The controllers will reconcile your changes with the workspace namespace(s).</p></li></ol><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="workspace-crd-fields"></a>Workspace CRD fields<a class="hash-link" href="#workspace-crd-fields" title="Direct link to heading">#</a></h2><p>The Workspace manifest defines three sections in its spec:</p><ul><li><code>gitProvider</code>: The git provider which should host the git repository of the workspace and an
access token for operating on the repo. Both GitHub and GitLab are supported.</li><li><code>gitRepository</code>: The repository details, which teams should get access to the workspace.
The team needs to exist in the provider. The branch and path, if specified, restrict the locations that will be examined for workloads that need to be deployed. Only manifests checked in on the specified branch within the specified repository directory will be processed; &quot;branch&quot; defaults to &quot;main&quot; and &quot;path&quot; defaults to &quot;./&quot;.</li><li><code>clusterScope</code>:<ul><li>the list of namespaces that are in the workspace.
For each of the namespaces, additional options may be defined:<ul><li><code>resourceQuota</code>: used to define constraints that limit aggregate resource consumption
in the namespace</li><li><code>limitRange</code>: used to define a policy to constrain resource allocations for pods or containers
running in the namespace</li></ul></li><li>the role of the members of the workspace with possible options:<ul><li><code>workspace-member</code>: members get limited permissions on the target namespaces</li><li><code>namespace-admin</code>: members get admin permissions on the target namespaces</li><li><code>cluster-admin</code>: members get cluster admin permissions</li></ul></li><li>a network policy for the namespaces with possible option:<ul><li><code>workspace-isolation</code>: services created in the target namespaces cannot be accessed
from namespaces outside of the workspace, and vice versa services running in namespaces
outside of the workspace, cannot be accessed from within the namespace. If this field is not
included in the manifest no network policy will be applied.</li></ul></li></ul></li></ul><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="cluster-access-for-workspace-teams"></a>Cluster access for workspace teams<a class="hash-link" href="#cluster-access-for-workspace-teams" title="Direct link to heading">#</a></h2><p>After creating a workspace the teams specified in the <code>gitRepository</code> section will have access to the repository. These teams can manage the workspace by adding and removing manifests, committing and pushing.</p><p>It is also very useful for these teams to have <code>kubectl</code> access to the workspace to view logs and deployment statuses. Limited access to only those namespaces managed by the workspace is provided by a service account automatically generated during the creation process. To generate a kubeconfig file that uses this service account run:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><div tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">wk workspaces kubeconfig --workspace-name demo</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>This will write the config to standard output and can be manually forwarded to the workspace teams. The teams can then save it to a file <code>demo-workspace-kubeconfig</code> use it like so:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><div tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">kubectl --kubeconfig</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">demo-workspace-kubeconfig get pods</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>The kubeconfig file sets the default namespace to the first namespace listed in the Workspace definition. In this case the above command will show the pods in <code>demo-app</code>. To interact with other workspace namespaces (like <code>demo-db</code> in this case), the usual kubectl namespace flag can be provided: <code>kubectl --kubeconfig=demo-workspace-kubeconfig --namespace=demo-db get pods</code></p><blockquote><p>If the cluster goes through a Kubernetes version upgrade, kubeconfig files will need to be regenerated.</p></blockquote><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="updating-a-workspace"></a>Updating a workspace<a class="hash-link" href="#updating-a-workspace" title="Direct link to heading">#</a></h2><p>After a workspace has been created, it is possible to change multiple of its fields.
The modifiable fields of the workspace CRD consist of:</p><p>in the <code>spec</code> map:</p><ul><li>the <code>interval</code> of the reconciliation</li><li>the <code>suspend</code> field, toggling the reconciliation on or off</li></ul><p>in the <code>clusterScope</code> map:</p><ul><li><p><code>namespaces</code> can be removed or added to the workspace. A namespace can only be in one workspace.
If the namespace doesn&#x27;t exist it will be created. When a namespace is removed from a workspace,
the members of the workspace will not be able to access it anymore, and deployments will not be
reconciled from the workspace repository.
Workload running in a removed namespace are not terminated.</p></li><li><p><code>resource quotas</code> and <code>limit ranges</code></p></li></ul></div></article><div class="margin-vert--xl"><div class="row"><div class="col"><a href="https://github.com/weaveworks/wkp-docs/tree/main/versioned_docs/version-2.4.2/team-workspaces/usage-guide.md" target="_blank" rel="noreferrer noopener"><svg fill="currentColor" height="1.2em" width="1.2em" preserveAspectRatio="xMidYMid meet" role="img" viewBox="0 0 40 40" class="iconEdit_2_ui" aria-label="Edit page"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div></div></div><div class="margin-vert--lg"><nav class="pagination-nav" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/docs/2.4.2/deploying-wkp/cluster-creation-on-footloose"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Â« Installing WKP on Footloose</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/docs/2.4.2/team-workspaces/team-permissions"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Specifying Team Permissions Â»</div></a></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_35-E thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#what-are-team-workspaces" class="table-of-contents__link">What are Team Workspaces?</a></li><li><a href="#how-to-enable-the-team-workspaces-feature" class="table-of-contents__link">How to: Enable the team workspaces feature</a></li><li><a href="#how-to-create-and-use-a-team-workspace" class="table-of-contents__link">How To: Create and use a team workspace</a><ul><li><a href="#using-a-github-token" class="table-of-contents__link">Using a GitHub token</a></li><li><a href="#using-a-gitlab-token" class="table-of-contents__link">Using a GitLab token</a></li><li><a href="#adding-a-token-manually" class="table-of-contents__link">Adding a token manually</a></li><li><a href="#creating-a-workspace" class="table-of-contents__link">Creating a Workspace</a></li></ul></li><li><a href="#workspace-crd-fields" class="table-of-contents__link">Workspace CRD fields</a></li><li><a href="#cluster-access-for-workspace-teams" class="table-of-contents__link">Cluster access for workspace teams</a></li><li><a href="#updating-a-workspace" class="table-of-contents__link">Updating a workspace</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><h4 class="footer__title">Support</h4><ul class="footer__items"><li class="footer__item"><a href="mailto:support@weave.works" target="_blank" rel="noopener noreferrer" class="footer__link-item">Contact Us</a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright Â© 2021 Weaveworks</div></div></div></footer></div>
<script src="/assets/js/styles.2455ccc5.js"></script>
<script src="/assets/js/runtime~main.5922fff2.js"></script>
<script src="/assets/js/main.0e16a271.js"></script>
<script src="/assets/js/1.88bfafc3.js"></script>
<script src="/assets/js/2.e8da588b.js"></script>
<script src="/assets/js/3.e8bbdb70.js"></script>
<script src="/assets/js/1be78505.f0d76dc0.js"></script>
<script src="/assets/js/142.d7e6d278.js"></script>
<script src="/assets/js/cb9bbae0.d7f83eb7.js"></script>
<script src="/assets/js/17896441.e06f1a31.js"></script>
<script src="/assets/js/83196782.432725ad.js"></script>
</body>
</html>