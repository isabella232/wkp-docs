<!doctype html>
<html lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-alpha.72">
<link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="WKP Technical Documentation Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="WKP Technical Documentation Blog Atom Feed"><title data-react-helmet="true">Managing the Sealing Key | WKP Technical Documentation</title><meta data-react-helmet="true" property="og:url" content="https://weaveworks.github.io/wkp-docs//docs/next/cluster-operations/sealing-key"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="Managing the Sealing Key | WKP Technical Documentation"><meta data-react-helmet="true" name="description" content="Sealed Secrets provide an effective means of managing secret information for your Kubernetes cluster, allowing you to check your secret information into a Version Control System (VCS) like Git. This allows you to manage your secrets via GitOps along with the rest of your cluster manifests."><meta data-react-helmet="true" property="og:description" content="Sealed Secrets provide an effective means of managing secret information for your Kubernetes cluster, allowing you to check your secret information into a Version Control System (VCS) like Git. This allows you to manage your secrets via GitOps along with the rest of your cluster manifests."><link data-react-helmet="true" rel="shortcut icon" href="/img/favicon_150px.png"><link data-react-helmet="true" rel="canonical" href="https://weaveworks.github.io/wkp-docs//docs/next/cluster-operations/sealing-key"><link data-react-helmet="true" rel="alternate" href="https://weaveworks.github.io/wkp-docs//docs/next/cluster-operations/sealing-key" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://weaveworks.github.io/wkp-docs//docs/next/cluster-operations/sealing-key" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.dc5b79e3.css">
<link rel="preload" href="/assets/js/styles.a4ab0e8c.js" as="script">
<link rel="preload" href="/assets/js/runtime~main.8c5e2d26.js" as="script">
<link rel="preload" href="/assets/js/main.595d6198.js" as="script">
<link rel="preload" href="/assets/js/1.ca3abcdf.js" as="script">
<link rel="preload" href="/assets/js/2.d7696af4.js" as="script">
<link rel="preload" href="/assets/js/143.0c07045b.js" as="script">
<link rel="preload" href="/assets/js/145.90272bda.js" as="script">
<link rel="preload" href="/assets/js/935f2afb.0f6ad1e5.js" as="script">
<link rel="preload" href="/assets/js/17896441.0677d20e.js" as="script">
<link rel="preload" href="/assets/js/346ceb7f.275cc8d8.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#main" class="skipToContent_1oUP">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle" type="button" tabindex="0"><svg aria-label="Menu" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><img src="/img/weave-logo.png" alt="WKP docs" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/img/weave-logo.png" alt="WKP docs" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"><strong class="navbar__title">WKP Docs</strong></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/">Getting Started</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/deploying-wkp/hosts">Install</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/tasks/using-the-eks-d-distribution">Tasks</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/cluster-operations/user-workloads">Cluster Operations</a></div><div class="navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a class="navbar__item navbar__link" href="/docs/next/">main</a><ul class="dropdown__menu"><li><a aria-current="page" class="dropdown__link dropdown__link--active" href="/docs/next/cluster-operations/sealing-key">main</a></li><li><a class="dropdown__link" href="/docs/cluster-operations/sealing-key">2.5.0</a></li><li><a class="dropdown__link" href="/docs/2.4.2/cluster-operations/sealing-key">2.4.2</a></li></ul></div><a href="https://github.com/weaveworks/wkp-docs/tree/main" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub</a><div class="react-toggle react-toggle--disabled displayOnlyInLargeViewport_GrZ2"><div class="react-toggle-track"><div class="react-toggle-track-check"><span class="toggle_71bT">ðŸŒœ</span></div><div class="react-toggle-track-x"><span class="toggle_71bT">ðŸŒž</span></div></div><div class="react-toggle-thumb"></div><input type="checkbox" disabled="" aria-label="Dark mode toggle" class="react-toggle-screenreader-only"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/"><img src="/img/weave-logo.png" alt="WKP docs" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/img/weave-logo.png" alt="WKP docs" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"><strong class="navbar__title">WKP Docs</strong></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a aria-current="page" class="menu__link navbar__link--active" href="/docs/">Getting Started</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link navbar__link--active" href="/docs/deploying-wkp/hosts">Install</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link navbar__link--active" href="/docs/tasks/using-the-eks-d-distribution">Tasks</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link navbar__link--active" href="/docs/cluster-operations/user-workloads">Cluster Operations</a></li><li class="menu__list-item"><a role="button" class="menu__link menu__link--sublist">Versions</a><ul class="menu__list"><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active" href="/docs/next/cluster-operations/sealing-key">main</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/cluster-operations/sealing-key">2.5.0</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/2.4.2/cluster-operations/sealing-key">2.4.2</a></li></ul></li><li class="menu__list-item"><a href="https://github.com/weaveworks/wkp-docs/tree/main" target="_blank" rel="noopener noreferrer" class="menu__link">GitHub</a></li></ul></div></div></div></nav><div class="main-wrapper main-docs-wrapper"><div class="docPage_31aa"><div class="docSidebarContainer_3Kbt" role="complementary"><div class="sidebar_15mo"><div class="menu menu--responsive thin-scrollbar menu_Bmed"><button aria-label="Open menu" aria-haspopup="true" class="button button--secondary button--sm menu__button" type="button"><svg aria-label="Menu" class="sidebarMenuIcon_fgN0" width="24" height="24" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><ul class="menu__list"><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Getting Started</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/next/">Introduction to wk</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/next/getting-started/wk">The wk command</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/next/getting-started/entitlements">Configuring Entitlements</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/next/getting-started/git-config-repository">Managing the Git Configuration Repository</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/next/getting-started/known-issues">Known Issues and Work Arounds</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Deploying WKP</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/next/deploying-wkp/hosts">Cluster Node Requirements</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/next/deploying-wkp/cluster-creation-on-ssh-nodes">Creating Clusters on SSH Nodes</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/next/deploying-wkp/components-on-existing-cluster">Install to an Existing Cluster</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/next/deploying-wkp/cluster-creation-on-eks">Cluster creation on EKS</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/next/deploying-wkp/cluster-creation-on-ssh-nodes">Creating Clusters on SSH Nodes</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/next/deploying-wkp/cluster-creation-on-footloose">Installing WKP on Footloose</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Multi-cluster Control Plane</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/next/mccp/intro">What is Multi-cluster Control Plane?</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/next/mccp/usage-guide">Usage guide</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/next/mccp/database-configuration">Configuring a Database</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Team Workspaces</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/next/team-workspaces/usage-guide">Implementing Team Workspaces</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/next/team-workspaces/team-permissions">Specifying Team Permissions</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/next/team-workspaces/member-guide">Deploying Workloads</a></li></ul></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!">Cluster Operations</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/next/cluster-operations/user-workloads">Running and Managing Workloads</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/next/cluster-operations/adding-removing-nodes">Adding and Removing Nodes</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/next/cluster-operations/upgrading-kubernetes-version">Upgrading Kubernetes</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/next/cluster-operations/custom-kubernetes-configuration">Customizing the API Server and Kubelet</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/next/cluster-operations/auth">Securing the WKP UI</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/next/cluster-operations/managing-secrets">Managing Secrets</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active active" tabindex="0" href="/docs/next/cluster-operations/sealing-key">Managing the Sealing Key</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Monitoring</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/next/monitoring/introduction">WKP Monitoring Tools</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/next/monitoring/alerts">Alerts</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/next/monitoring/dashboards">Dashboards</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Tasks</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/next/tasks/control-plane-load-balancers">Control Plane Load Balancing</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/next/tasks/using-the-eks-d-distribution">Configuring EKS-D</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/next/tasks/multiple-cluster-admins">Specifying Multiple Admins</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/next/tasks/patching-node-os-packages">Patching Node OS packages</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/next/tasks/profiling-kubectl">Profiling kubectl</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Troubleshooting</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/next/troubleshooting/help">Debugging a Problem</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/next/troubleshooting/kubelet">Troubleshooting kubelet</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/next/troubleshooting/controller">Troubleshooting wks-controller</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/next/troubleshooting/scope">WKP Scope</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/next/tasks/patching-node-os-packages">Patching Node OS packages</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/next/tasks/profiling-kubectl">Profiling kubectl</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">FAQ</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/next/FAQ/faq">Frequently Asked Questions</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Reference</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/next/reference/reference">Cluster and Machine Objects</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/next/reference/cluster">cluster.yaml</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/next/reference/machines">machines.yaml</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Thirdparty Dependencies</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/next/deps/dependencies">Third-party Dependencies</a></li></ul></li></ul></div></div></div><main class="docMainContainer_3ufF"><div class="container padding-vert--lg docItemWrapper_3FMP"><div class="row"><div class="col docItemCol_3FnS"><div class="alert alert--warning margin-bottom--md" role="alert"><div>This is unreleased documentation for WKP Technical Documentation <strong>main</strong> version.</div><div class="margin-top--md">For up-to-date documentation, see the <strong><a href="/docs/cluster-operations/sealing-key">latest version</a></strong> (2.5.0).</div></div><div class="docItemContainer_33ec"><article><div><span class="badge badge--secondary">Version: main</span></div><header><h1 class="docTitle_3a4h">Managing the Sealing Key</h1></header><div class="markdown"><p><a href="https://engineering.bitnami.com/articles/sealed-secrets.html" target="_blank" rel="noopener noreferrer">Sealed Secrets</a> provide an effective means of managing secret information for your Kubernetes cluster, allowing you to check your secret information into a Version Control System (VCS) like Git. This allows you to manage your secrets via GitOps along with the rest of your cluster manifests.</p><p>However, the security of your system and its secrets depends on safely managing the <code>sealing key</code>. The sealing key is the key used by the <code>Sealed Secret</code> controller to decrypt your sealed secrets when they are applied to your cluster. As described in <a href="/getting-started/managing-secrets/">Managing Secrets</a>, at cluster creation time the sealing key may be provided by you or automatically generated by <code>wkp</code>. In either case, it is the one piece of information that <em>must</em> be controlled. Anyone with access to the sealing key can decrypt any sealed secret that was encrypted with the corresponding certificate.</p><p>To ensure you can decrypt your sealed secrets in the event of a catastrophic cluster failure, save your sealing key in a secure location such as a password manager or a dedicated secret management system like Hashicorp Vault.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="key-renewal-and-multiple-sealing-keys"></a>Key Renewal and Multiple Sealing Keys<a class="hash-link" href="#key-renewal-and-multiple-sealing-keys" title="Direct link to heading">#</a></h2><p>By default, the Sealed Secrets controller periodically performs an operation called <code>key renewal</code> which creates a new sealing key and corresponding certificate (default period: 30 days). After a key renewal, any secrets sealed with <code>kubeseal</code> will be encrypted with the new certificate unless an older one is explicitly specified on the command line. The controller will then use the new sealing key to decrypt it.</p><p>If left alone, this will generate a growing set of sealing keys associated with the controller. The controller will use the appropriate key to decrypt each sealed secret depending on which certificate was used to create it. This means that any backup of sealing keys must take into account the new keys generated via <code>key renewal</code>. You have three options:</p><ol><li>Turn off key renewal (not recommended)</li><li>Periodically add any new sealing keys to your secret backup storage</li><li>Periodically re-encrypt your existing sealed secrets with the current sealing key (recommended)</li></ol><p>The third option is supported via <code>kubeseal</code> with the <code>re-encrypt</code> flag:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><div tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">kubeseal --re-encrypt </span><span class="token operator" style="color:rgb(137, 221, 255)">&lt;</span><span class="token plain"> yourSealedSecret.yaml </span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;</span><span class="token plain"> aTempFile.yaml </span><span class="token operator" style="color:rgb(137, 221, 255)">&amp;&amp;</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">mv</span><span class="token plain"> aTempFile.yaml yourSealedSecret.yaml</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>Once you perform this operation for each sealed secret, you are free to label any preexisting sealing key secret as <code>compromised</code>:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><div tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">kubectl --namespace kube-system label secrets yourSealedSecretKey sealedsecrets.bitnami.com/sealed-secrets-key</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">compromised --overwrite</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">true</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>All the keys may be located via:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><div tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">kubectl get secret --namespace kube-system -l sealedsecrets.bitnami.com/sealed-secrets-key</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>A restart of the sealed secret controller will ignore any compromised keys.</p><p>As discussed in <a href="/getting-started/managing-secrets/">Managing Secrets</a>, key renewal (automatic or manual) is not a substitute for rotating your actual secrets. In particular, it&#x27;s important to keep in mind that the security leak caused by a breached sealing key can not be corrected merely by removing and regenerating the sealing key. You need to assume that all secrets encrypted with the sealing key are compromised and rotate your secret information.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="recoverying-sealing-keys-from-the-cluster"></a>Recoverying sealing keys from the cluster<a class="hash-link" href="#recoverying-sealing-keys-from-the-cluster" title="Direct link to heading">#</a></h2><p>For option 2 above (or if you did not back up your keys), you can recover your keys as long as your cluster is operational. The following command will extract the keys from your cluster:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><div tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">kubectl get secret --namespace kube-system -l sealedsecrets.bitnami.com/sealed-secrets-key --output yaml </span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;</span><span class="token plain"> yourKeyFile.yaml</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>You can apply them to a cluster as part of disaster recovery via:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><div tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">kubectl apply --filename yourKeyFile.yaml</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>If the controller is already running, restart the controller to install the recovered keys:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><div tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">kubectl delete pod --namespace kube-system -l </span><span class="token assign-left variable" style="color:rgb(191, 199, 213)">name</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">sealed-secrets-controller</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="recoverying-secrets-after-a-cluster-failure"></a>Recoverying secrets after a cluster failure<a class="hash-link" href="#recoverying-secrets-after-a-cluster-failure" title="Direct link to heading">#</a></h2><p>If your cluster has failed and you have sealed secrets stored in version control or on your filesystem, you can recover your secret information provided you backed up your sealing keys as described above. You can decrypt your sealed secrets using:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><div tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">kubeseal --recovery-unseal --recovery-private-key yourSealingKey1,yourSealingKey2,</span><span class="token punctuation" style="color:rgb(199, 146, 234)">..</span><span class="token plain">. </span><span class="token operator" style="color:rgb(137, 221, 255)">&lt;</span><span class="token plain"> yourSealedSecret.yaml</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>or</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><div tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">kubeseal --recovery-unseal --recovery-private-key yourSealingKey1 --recovery-private-key yourSealingKey2 </span><span class="token punctuation" style="color:rgb(199, 146, 234)">..</span><span class="token plain">. </span><span class="token operator" style="color:rgb(137, 221, 255)">&lt;</span><span class="token plain"> yourSealedSecret.yaml</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div></div></article><div class="margin-vert--xl"><div class="row"><div class="col"><a href="https://github.com/weaveworks/wkp-docs/tree/main/docs/cluster-operations/sealing-key.md" target="_blank" rel="noreferrer noopener"><svg fill="currentColor" height="1.2em" width="1.2em" preserveAspectRatio="xMidYMid meet" role="img" viewBox="0 0 40 40" class="iconEdit_2_ui" aria-label="Edit page"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div></div></div><div class="margin-vert--lg"><nav class="pagination-nav" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/docs/next/cluster-operations/managing-secrets"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Â« Managing Secrets</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/docs/next/monitoring/introduction"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">WKP Monitoring Tools Â»</div></a></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_35-E thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#key-renewal-and-multiple-sealing-keys" class="table-of-contents__link">Key Renewal and Multiple Sealing Keys</a></li><li><a href="#recoverying-sealing-keys-from-the-cluster" class="table-of-contents__link">Recoverying sealing keys from the cluster</a></li><li><a href="#recoverying-secrets-after-a-cluster-failure" class="table-of-contents__link">Recoverying secrets after a cluster failure</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><h4 class="footer__title">Support</h4><ul class="footer__items"><li class="footer__item"><a href="mailto:support@weave.works" target="_blank" rel="noopener noreferrer" class="footer__link-item">Contact Us</a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright Â© 2021 Weaveworks</div></div></div></footer></div>
<script src="/assets/js/styles.a4ab0e8c.js"></script>
<script src="/assets/js/runtime~main.8c5e2d26.js"></script>
<script src="/assets/js/main.595d6198.js"></script>
<script src="/assets/js/1.ca3abcdf.js"></script>
<script src="/assets/js/2.d7696af4.js"></script>
<script src="/assets/js/143.0c07045b.js"></script>
<script src="/assets/js/145.90272bda.js"></script>
<script src="/assets/js/935f2afb.0f6ad1e5.js"></script>
<script src="/assets/js/17896441.0677d20e.js"></script>
<script src="/assets/js/346ceb7f.275cc8d8.js"></script>
</body>
</html>