<!doctype html>
<html lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-alpha.72">
<link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="WKP Technical Documentation Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="WKP Technical Documentation Blog Atom Feed"><title data-react-helmet="true">Specifying Team Permissions | WKP Technical Documentation</title><meta data-react-helmet="true" property="og:url" content="https://weaveworks.github.io/wkp-docs//docs/next/team-workspaces/team-permissions"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="Specifying Team Permissions | WKP Technical Documentation"><meta data-react-helmet="true" name="description" content="Workspaces may require different permission levels for their members. Permissions granted"><meta data-react-helmet="true" property="og:description" content="Workspaces may require different permission levels for their members. Permissions granted"><link data-react-helmet="true" rel="shortcut icon" href="/img/favicon_150px.png"><link data-react-helmet="true" rel="canonical" href="https://weaveworks.github.io/wkp-docs//docs/next/team-workspaces/team-permissions"><link data-react-helmet="true" rel="alternate" href="https://weaveworks.github.io/wkp-docs//docs/next/team-workspaces/team-permissions" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://weaveworks.github.io/wkp-docs//docs/next/team-workspaces/team-permissions" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.68a53ba0.css">
<link rel="preload" href="/assets/js/styles.33396f25.js" as="script">
<link rel="preload" href="/assets/js/runtime~main.bc9dd537.js" as="script">
<link rel="preload" href="/assets/js/main.c35682a3.js" as="script">
<link rel="preload" href="/assets/js/1.9012e3cd.js" as="script">
<link rel="preload" href="/assets/js/2.ccda5862.js" as="script">
<link rel="preload" href="/assets/js/3.215ce606.js" as="script">
<link rel="preload" href="/assets/js/1be78505.30f07329.js" as="script">
<link rel="preload" href="/assets/js/147.2693a768.js" as="script">
<link rel="preload" href="/assets/js/935f2afb.8174fbf9.js" as="script">
<link rel="preload" href="/assets/js/17896441.d853433f.js" as="script">
<link rel="preload" href="/assets/js/67177718.8d3daf82.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#main" class="skipToContent_1oUP">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle" type="button" tabindex="0"><svg aria-label="Menu" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><img src="/img/weave-logo.png" alt="WKP docs" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/img/weave-logo.png" alt="WKP docs" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"><strong class="navbar__title">WKP Docs</strong></a><a class="navbar__item navbar__link navbar__link--active" href="/docs/next/">WKP</a><a class="navbar__item navbar__link" href="/docs/next/mccp/intro">Multi-Cluster Control Plane</a></div><div class="navbar__items navbar__items--right"><a class="navbar__item navbar__link" href="/docs/next/download">WKP Downloads</a><a class="navbar__item navbar__link" href="/docs/next/release-notes">Release Notes</a><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a class="navbar__item navbar__link" href="/docs/next/">main</a><ul class="dropdown__menu"><li><a aria-current="page" class="dropdown__link dropdown__link--active" href="/docs/next/team-workspaces/team-permissions">main</a></li><li><a class="dropdown__link" href="/docs/team-workspaces/team-permissions">2.5.0</a></li><li><a class="dropdown__link" href="/docs/2.4.2/team-workspaces/team-permissions">2.4.2</a></li></ul></div><a href="https://github.com/weaveworks/wkp-docs/tree/main" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub</a><div class="react-toggle react-toggle--disabled displayOnlyInLargeViewport_GrZ2"><div class="react-toggle-track"><div class="react-toggle-track-check"><span class="toggle_71bT">ðŸŒœ</span></div><div class="react-toggle-track-x"><span class="toggle_71bT">ðŸŒž</span></div></div><div class="react-toggle-thumb"></div><input type="checkbox" disabled="" aria-label="Dark mode toggle" class="react-toggle-screenreader-only"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/"><img src="/img/weave-logo.png" alt="WKP docs" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/img/weave-logo.png" alt="WKP docs" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"><strong class="navbar__title">WKP Docs</strong></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a class="menu__link navbar__link--active" href="/docs/next/">WKP</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/next/mccp/intro">Multi-Cluster Control Plane</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/next/download">WKP Downloads</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/next/release-notes">Release Notes</a></li><li class="menu__list-item"><a role="button" class="menu__link menu__link--sublist">Versions</a><ul class="menu__list"><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active" href="/docs/next/team-workspaces/team-permissions">main</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/team-workspaces/team-permissions">2.5.0</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/2.4.2/team-workspaces/team-permissions">2.4.2</a></li></ul></li><li class="menu__list-item"><a href="https://github.com/weaveworks/wkp-docs/tree/main" target="_blank" rel="noopener noreferrer" class="menu__link">GitHub</a></li></ul></div></div></div></nav><div class="main-wrapper main-docs-wrapper"><div class="docPage_31aa"><div class="docSidebarContainer_3Kbt" role="complementary"><div class="sidebar_15mo"><div class="menu menu--responsive thin-scrollbar menu_Bmed"><button aria-label="Open menu" aria-haspopup="true" class="button button--secondary button--sm menu__button" type="button"><svg aria-label="Menu" class="sidebarMenuIcon_fgN0" width="24" height="24" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><ul class="menu__list"><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Getting Started</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/next/">Introduction to wk</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/next/getting-started/wk">The wk command</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/next/getting-started/entitlements">Configuring Entitlements</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/next/getting-started/git-config-repository">Managing the Git Configuration Repository</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/next/getting-started/known-issues">Known Issues and Work Arounds</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Deploying WKP</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/next/deploying-wkp/hosts">Cluster Node Requirements</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/next/deploying-wkp/cluster-creation-on-ssh-nodes">Creating Clusters on SSH Nodes</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/next/deploying-wkp/components-on-existing-cluster">Install to an Existing Cluster</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/next/deploying-wkp/cluster-creation-on-eks">Cluster creation on EKS</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/next/deploying-wkp/cluster-creation-on-footloose">Installing WKP on Footloose</a></li></ul></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!">Team Workspaces</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/next/team-workspaces/usage-guide">Implementing Team Workspaces</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active active" tabindex="0" href="/docs/next/team-workspaces/team-permissions">Specifying Team Permissions</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/next/team-workspaces/member-guide">Deploying Workloads</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Cluster Operations</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/next/cluster-operations/user-workloads">Running and Managing Workloads</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/next/cluster-operations/adding-removing-nodes">Adding and Removing Nodes</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/next/cluster-operations/upgrading-kubernetes-version">Upgrading Kubernetes</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/next/cluster-operations/custom-kubernetes-configuration">Customizing the API Server and Kubelet</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/next/cluster-operations/auth">Securing the WKP UI</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/next/cluster-operations/nats-tls">Securing NATS</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/next/cluster-operations/managing-secrets">Managing Secrets</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/next/cluster-operations/sealing-key">Managing the Sealing Key</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Monitoring</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/next/monitoring/introduction">WKP Monitoring Tools</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/next/monitoring/alerts">Alerts</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/next/monitoring/dashboards">Dashboards</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Tasks</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/next/tasks/control-plane-load-balancers">Control Plane Load Balancing</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/next/tasks/using-the-eks-d-distribution">Configuring EKS-D</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/next/tasks/multiple-cluster-admins">Specifying Multiple Admins</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/next/tasks/patching-node-os-packages">Patching Node OS packages</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/next/tasks/profiling-kubectl">Profiling kubectl</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Troubleshooting</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/next/troubleshooting/help">Debugging a Problem</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/next/troubleshooting/kubelet">Troubleshooting kubelet</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/next/troubleshooting/controller">Troubleshooting wks-controller</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/next/troubleshooting/scope">WKP Scope</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/next/tasks/patching-node-os-packages">Patching Node OS packages</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/next/tasks/profiling-kubectl">Profiling kubectl</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">FAQ</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/next/FAQ/faq">Frequently Asked Questions</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Reference</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/next/reference/reference">Cluster and Machine Objects</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/next/reference/cluster">cluster.yaml</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/next/reference/machines">machines.yaml</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Thirdparty Dependencies</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/next/deps/dependencies">Third-party Dependencies</a></li></ul></li></ul></div></div></div><main class="docMainContainer_3ufF"><div class="container padding-vert--lg docItemWrapper_3FMP"><div class="row"><div class="col docItemCol_3FnS"><div class="alert alert--warning margin-bottom--md" role="alert"><div>This is unreleased documentation for WKP Technical Documentation <strong>main</strong> version.</div><div class="margin-top--md">For up-to-date documentation, see the <strong><a href="/docs/team-workspaces/team-permissions">latest version</a></strong> (2.5.0).</div></div><div class="docItemContainer_33ec"><article><div><span class="badge badge--secondary">Version: main</span></div><header><h1 class="docTitle_3a4h">Specifying Team Permissions</h1></header><div class="markdown"><p>Workspaces may require different permission levels for their members. Permissions granted
for each workspace are set by the role in the Workspace custom resource.
WKP provides 3 levels by default:</p><ul><li><code>workspace-member</code></li><li><code>namespace-admin</code></li><li><code>cluster-admin</code></li></ul><p>but it can support any custom <code>ClusterRole</code> the cluster admin has created in the cluster.</p><p>In more detail the permissions of each role:</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="workspace-member"></a>workspace-member<a class="hash-link" href="#workspace-member" title="Direct link to heading">#</a></h3><p>This role is applicable to dev teams as members of the workspace are able to perform all
operations in the provided namespaces, but do not have permissions to modify tenant
policies that may be created, such as resource quotas, limit ranges, and network policies.</p><p>The <code>workspace-member</code> role manifest is added in the cluster repository in the
<code>cluster/platform/workspaces</code> directory and is reconciled by the flux instance in the
<code>wkp-flux</code> namespace, allowing for modification based on your requirements.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="namespace-admin"></a>namespace-admin<a class="hash-link" href="#namespace-admin" title="Direct link to heading">#</a></h3><p>This role grants namespace admin permissions to the namespaces that are in the workspace.
Members are able to modify all objects and resource in the namespace, making it more
relevant for teams in clusters without strict resource restrictions.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="cluster-admin"></a>cluster-admin<a class="hash-link" href="#cluster-admin" title="Direct link to heading">#</a></h3><p>This role grants cluster admin permission to the entire cluster. It is applicable to
infrastructure teams that may require to create namespaces, or deploy non namespaced objects, like custom resource definitions.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="how-to-allow-teams-with-workspace-member-access-to-create-non-namespaced-objects"></a>How to: Allow teams with <code>workspace-member</code> access to create non-namespaced objects<a class="hash-link" href="#how-to-allow-teams-with-workspace-member-access-to-create-non-namespaced-objects" title="Direct link to heading">#</a></h2><p>Members of a workspace may need to create non-namespaced objects, but it may not
be possible to grant the team cluster-admin permissions.
This use case can be addressed by binding multiple <code>ClusterRoles</code> to the service account
of the specific workspace.</p><p>An example of a <code>ClusterRole</code> and <code>ClusterRoleBinding</code> that grant permissions
to create <code>Custom Resource Definitions</code>, are provided in the
<code>cluster/platform/workspaces</code> directory. See:</p><ul><li><code>cluster/platform/workspaces/crd-manager-clusterrole.yaml</code></li><li><code>cluster/platform/workspaces/crd-manager-clusterrolebinding.yaml</code></li></ul><p>To apply it to a workspace, create a copy of the <code>ClusterRoleBinding</code> file and
set the name of the placeholder of the service account to the name of the target workspace, and
push the file to the cluster repository.
After the reconciliation loop is completed, member permissions are updated and they should be able to create CRDs,
without any further action from them.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="git-commit-statuses"></a>Git commit statuses<a class="hash-link" href="#git-commit-statuses" title="Direct link to heading">#</a></h2><p>A workspace repository shows updates about the reconciliation of the manifests in the git commit
status.
This functionality leverages the <a href="https://toolkit.fluxcd.io/guides/notifications/#git-commit-status" target="_blank" rel="noopener noreferrer">Gitops Toolkit</a>
notifications.
To set up, an <code>Alert</code> and <code>Provider</code> object are created in the <code>wkp-workspaces</code> namespace during
workspace creation.</p><p>If there has been an error in the reconciliation, the status message shows an error and a
message with the relevant logs. Alternatively, the status of the reconciliation can be retrieved by
the <code>Kustomization</code> object of the workspace.</p><p>The object has the name of the workspace and is created in the wkp-workspaces namespace.</p><p>Please refer workspace members to the <code>Debugging manifest reconciliation</code> section of the member
guide, for debugging information and steps on the reconciliation of committed manifests.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="more-information"></a>More Information<a class="hash-link" href="#more-information" title="Direct link to heading">#</a></h2><p>For more information on how Role Based Access Control works in WKP, please
refer to the kubernetes documentation at:
<a href="https://kubernetes.io/docs/reference/access-authn-authz/rbac/" target="_blank" rel="noopener noreferrer">https://kubernetes.io/docs/reference/access-authn-authz/rbac/</a></p></div></article><div class="margin-vert--xl"><div class="row"><div class="col"><a href="https://github.com/weaveworks/wkp-docs/tree/main/docs/team-workspaces/team-permissions.md" target="_blank" rel="noreferrer noopener"><svg fill="currentColor" height="1.2em" width="1.2em" preserveAspectRatio="xMidYMid meet" role="img" viewBox="0 0 40 40" class="iconEdit_2_ui" aria-label="Edit page"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div></div></div><div class="margin-vert--lg"><nav class="pagination-nav" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/docs/next/team-workspaces/usage-guide"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Â« Implementing Team Workspaces</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/docs/next/team-workspaces/member-guide"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Deploying Workloads Â»</div></a></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_35-E thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#workspace-member" class="table-of-contents__link">workspace-member</a></li><li><a href="#namespace-admin" class="table-of-contents__link">namespace-admin</a></li><li><a href="#cluster-admin" class="table-of-contents__link">cluster-admin</a></li><li><a href="#how-to-allow-teams-with-workspace-member-access-to-create-non-namespaced-objects" class="table-of-contents__link">How to: Allow teams with <code>workspace-member</code> access to create non-namespaced objects</a></li><li><a href="#git-commit-statuses" class="table-of-contents__link">Git commit statuses</a></li><li><a href="#more-information" class="table-of-contents__link">More Information</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><h4 class="footer__title">Support</h4><ul class="footer__items"><li class="footer__item"><a href="mailto:support@weave.works" target="_blank" rel="noopener noreferrer" class="footer__link-item">Contact Us</a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright Â© 2021 Weaveworks</div></div></div></footer></div>
<script src="/assets/js/styles.33396f25.js"></script>
<script src="/assets/js/runtime~main.bc9dd537.js"></script>
<script src="/assets/js/main.c35682a3.js"></script>
<script src="/assets/js/1.9012e3cd.js"></script>
<script src="/assets/js/2.ccda5862.js"></script>
<script src="/assets/js/3.215ce606.js"></script>
<script src="/assets/js/1be78505.30f07329.js"></script>
<script src="/assets/js/147.2693a768.js"></script>
<script src="/assets/js/935f2afb.8174fbf9.js"></script>
<script src="/assets/js/17896441.d853433f.js"></script>
<script src="/assets/js/67177718.8d3daf82.js"></script>
</body>
</html>